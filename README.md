# Type to Death

A typing game that combines skill-building with horror-inspired gameplay mechanics. Players must improve their typing speed and accuracy while managing the threat of a monster that teleports closer every time they blink.

## üéÆ Game Concept

**The Blink Mechanic:**
- A monster exists in the 3D scene at a distance from the player
- The monster teleports closer to the player every time they blink
- Players must balance keeping their eyes open while completing typing challenges
- Uses Google MediaPipe to detect player blinks via webcam
- If the monster reaches a certain distance, it attacks and the game ends

## üèóÔ∏è Project Structure

This is a monorepo containing:

- **`app-next/`** - Next.js frontend with Convex backend (current implementation)
- **`unity/`** - Unity WebGL game build

## üöÄ Quick Start (Next.js App)

### Prerequisites

- **Node.js** 18+ and npm/pnpm/yarn/bun
- **Webcam** (required for blink detection)
- **Convex Account** (free tier available at [convex.dev](https://convex.dev))

### 1. Clone the Repository

```bash
git clone <repository-url>
cd type-to-death
```

### 2. Install Dependencies

```bash
cd app-next
npm install
# or
pnpm install
# or
bun install
```

### 3. Set Up Convex Backend

#### Create a Convex Account

1. Go to [convex.dev](https://convex.dev) and sign up for a free account
2. Install the Convex CLI globally (optional but recommended):

```bash
npm install -g convex
```

#### Initialize Convex

```bash
# From the app-next directory
npx convex dev
```

This will:
- Prompt you to log in to Convex
- Create a new Convex project (or select an existing one)
- Generate a `.env.local` file with your Convex deployment URL
- Start the Convex development server
- Deploy your backend functions

#### Configure Environment Variables

After running `npx convex dev`, your `.env.local` file should look like:

```bash
# Deployment used by `npx convex dev`
CONVEX_DEPLOYMENT=dev:your-deployment-name

NEXT_PUBLIC_CONVEX_URL=https://your-deployment-name.convex.cloud
```

**Note:** The `.env.local` file is already created by `npx convex dev`. You don't need to create it manually.

### 4. Run the Development Server

Open two terminal windows:

**Terminal 1 - Convex Backend:**
```bash
cd app-next
npx convex dev
```

**Terminal 2 - Next.js Frontend:**
```bash
cd app-next
npm run dev
# or
pnpm dev
# or
bun dev
```

### 5. Open the App

Navigate to [http://localhost:3000](http://localhost:3000) in your browser.

**Important:** Allow webcam access when prompted - it's required for blink detection!

## üì¶ Convex Backend Details

### What is Convex?

Convex is a backend-as-a-service that provides:
- Real-time database
- Serverless functions (queries, mutations, actions)
- Authentication
- Scheduled jobs (crons)
- File storage

### Backend Structure

```
app-next/convex/
‚îú‚îÄ‚îÄ auth.config.ts      # Authentication configuration
‚îú‚îÄ‚îÄ auth.ts             # Auth helper functions
‚îú‚îÄ‚îÄ crons.ts            # Scheduled jobs
‚îú‚îÄ‚îÄ highscores.ts       # High score queries and mutations
‚îú‚îÄ‚îÄ http.ts             # HTTP endpoints
‚îú‚îÄ‚îÄ schema.ts           # Database schema
‚îú‚îÄ‚îÄ stories.ts          # Story generation functions
‚îú‚îÄ‚îÄ users.ts            # User management
‚îî‚îÄ‚îÄ _generated/         # Auto-generated Convex code
```

### Key Features

- **Authentication**: Convex Auth with multiple providers
- **High Scores**: Real-time leaderboard system
- **Story Generation**: AI-powered story generation (uses Anthropic API)
- **Scheduled Jobs**: Automated tasks via crons

### Database Schema

The app uses the following tables:
- `users` - User profiles and authentication
- `highscores` - Game high scores with timestamps
- `stories` - Generated horror stories for typing challenges

### Convex CLI Commands

```bash
# Start development server
npx convex dev

# Deploy to production
npx convex deploy

# View logs
npx convex logs

# Open Convex dashboard
npx convex dashboard

# Run a function manually
npx convex run <functionName>

# View help
npx convex -h
```

## üîß Configuration

### Convex Authentication

The app uses Convex Auth. To configure authentication providers, edit:

```typescript
// app-next/convex/auth.config.ts
```

### Environment Variables

Required environment variables in `.env.local`:

```bash
# Convex (auto-generated by `npx convex dev`)
CONVEX_DEPLOYMENT=dev:your-deployment-name
NEXT_PUBLIC_CONVEX_URL=https://your-deployment-name.convex.cloud

# Optional: For AI story generation
ANTHROPIC_API_KEY=your-anthropic-api-key
```

## üéØ Features

- **Blink Detection**: Real-time blink tracking using Google MediaPipe
- **Typing Challenges**: Dynamic typing tests with accuracy tracking
- **High Scores**: Global leaderboard with real-time updates
- **AI Stories**: Procedurally generated horror stories for typing
- **3D Monster**: Unity WebGL integration for immersive gameplay
- **Authentication**: User accounts and progress tracking

## üõ†Ô∏è Development

### Tech Stack

**Frontend:**
- Next.js 16 (App Router)
- React 19
- TypeScript
- Tailwind CSS v4
- shadcn/ui components
- Zustand (state management)
- Google MediaPipe (blink detection)

**Backend:**
- Convex (database + serverless functions)
- Convex Auth (authentication)
- Anthropic Claude API (story generation)

**Game:**
- Unity 6.1 (WebGL build)
- React Unity WebGL integration

### Project Commands

```bash
# Development
npm run dev          # Start Next.js dev server
npx convex dev       # Start Convex backend

# Build
npm run build        # Build for production
npx convex deploy    # Deploy backend to production

# Linting
npm run lint         # Run ESLint
```

## üìö Documentation

- **Specs**: Feature specifications in `.kiro/specs/`
- **Steering Rules**: Development standards in `.kiro/steering/`
- **AI Docs**: Generated documentation in `docs-ai/`

## ü§ù Contributing

This is a hackathon project (Kiroween). Contributions are welcome!

### Development Standards

- Follow [Conventional Commits](https://www.conventionalcommits.org/)
- Use TypeScript for type safety
- Use `@/` import aliases (never relative paths)
- Use shadcn/ui components for UI
- Use Zustand for global state management
- Follow Unity 6.1 standards for game code

See `.kiro/steering/` for detailed development guidelines.

## üìù License

See [LICENSE](LICENSE) file for details.

---

**Need Help?**

- Convex Docs: [docs.convex.dev](https://docs.convex.dev)
- Next.js Docs: [nextjs.org/docs](https://nextjs.org/docs)
- MediaPipe Docs: [developers.google.com/mediapipe](https://developers.google.com/mediapipe)



